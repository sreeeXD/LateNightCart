{% extends "base.html" %}
{% block title %}Admin Dashboard - LateNightCart{% endblock %}
{% block content %}

<section class="px-4 md:px-10 pt-24 pb-16 min-h-screen">
  <!-- Dashboard Header -->
  <div class="text-center mb-10">
    <h1 class="text-4xl md:text-5xl font-extrabold text-yellow-400 glow-text mb-2">Admin Dashboard</h1>
    <p class="text-gray-400">Manage your snacks, orders, and users with ease.</p>
  </div>

  <!-- Stats Overview -->
  <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-12">
    <div class="bg-gray-800/80 border border-gray-700 rounded-2xl p-6 text-center shadow-lg hover:shadow-yellow-500/20 transition">
      <h3 class="text-gray-400 text-sm uppercase">Total Snacks</h3>
      <p class="text-3xl font-bold text-yellow-400 mt-2">{{ snacks|length }}</p>
    </div>

    <div class="bg-gray-800/80 border border-gray-700 rounded-2xl p-6 text-center shadow-lg hover:shadow-yellow-500/20 transition">
      <h3 class="text-gray-400 text-sm uppercase">Total Orders</h3>
      <p class="text-3xl font-bold text-yellow-400 mt-2">{{ orders|length if orders else 0 }}</p>
    </div>

    <div class="bg-gray-800/80 border border-gray-700 rounded-2xl p-6 text-center shadow-lg hover:shadow-yellow-500/20 transition">
      <h3 class="text-gray-400 text-sm uppercase">Pending Orders</h3>
      <p class="text-3xl font-bold text-yellow-400 mt-2">
        {{ orders|selectattr("status", "equalto", "Pending")|list|length if orders else 0 }}
      </p>
    </div>

    <div class="bg-gray-800/80 border border-gray-700 rounded-2xl p-6 text-center shadow-lg hover:shadow-yellow-500/20 transition">
      <h3 class="text-gray-400 text-sm uppercase">Completed Orders</h3>
      <p class="text-3xl font-bold text-yellow-400 mt-2">
        {{ orders|selectattr("status", "equalto", "Completed")|list|length if orders else 0 }}
      </p>
    </div>
  </div>

  <!-- Admin Actions -->
  <div class="flex flex-wrap justify-center gap-6 mb-10">
    <a href="{{ url_for('manage_snack') }}" 
       class="px-6 py-3 bg-yellow-500 text-black font-semibold rounded-lg hover:bg-yellow-400 transition shadow-lg">
      ğŸ¥¨ Manage Snacks
    </a>
    <a href="{{ url_for('snacks') }}" 
       class="px-6 py-3 bg-gray-700 text-yellow-400 font-semibold rounded-lg hover:bg-gray-600 transition shadow-lg">
      ğŸ‘€ View as Customer
    </a>
  </div>

  <!-- Recent Orders Table -->
  <div class="overflow-x-auto">
    <table class="min-w-full bg-gray-900/60 border border-gray-700 rounded-2xl shadow-lg">
      <thead class="bg-gray-800 border-b border-gray-700">
        <tr>
          <th class="text-left text-yellow-400 py-3 px-4">Order ID</th>
          <th class="text-left text-yellow-400 py-3 px-4">Snack</th>
          <th class="text-left text-yellow-400 py-3 px-4">Buyer</th>
          <th class="text-left text-yellow-400 py-3 px-4">Room</th>
          <th class="text-left text-yellow-400 py-3 px-4">Quantity</th>
          <th class="text-left text-yellow-400 py-3 px-4">Status</th>
          <th class="text-left text-yellow-400 py-3 px-4">Actions</th>
        </tr>
      </thead>
      <tbody>
        {% if orders %}
          {% for order in orders %}
          <tr class="border-b border-gray-700 hover:bg-gray-800/70 transition">
            <td class="py-3 px-4 text-gray-300">{{ order.id }}</td>
            <td class="py-3 px-4 text-gray-300">{{ order.snack.name }}</td>
            <td class="py-3 px-4 text-gray-300">{{ order.buyer_name }}</td>
            <td class="py-3 px-4 text-gray-300">{{ order.room_number }}</td>
            <td class="py-3 px-4 text-gray-300">{{ order.quantity_ordered }}</td>
            <td class="py-3 px-4">
              {% if order.status == "Completed" %}
                <span class="bg-green-600/60 text-white px-2 py-1 rounded-lg text-sm">Completed</span>
              {% else %}
                <span class="bg-yellow-600/60 text-white px-2 py-1 rounded-lg text-sm">Pending</span>
              {% endif %}
            </td>
            <td class="py-3 px-4">
              {% if order.status == "Pending" %}
              <a href="{{ url_for('complete_order', order_id=order.id) }}" 
                 class="bg-green-500 hover:bg-green-400 text-black px-3 py-1 rounded-lg text-sm font-semibold transition">
                Mark Done
              </a>
              {% endif %}
            </td>
          </tr>
          {% endfor %}
        {% else %}
          <tr>
            <td colspan="7" class="text-center text-gray-400 py-6">No orders yet ğŸª</td>
          </tr>
        {% endif %}
      </tbody>
    </table>
  </div>
</section>

{% endblock %}
