<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Late Night Cart - Our Snacks</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/output.css') }}">
    <style> /* [Copy your custom color variables and font styles here] */
        :root {
            --color-white: #fcfcfc; --color-black: #0a0a0a; --color-dark-olive: #373012; 
            --color-medium-olive: #64561a; --color-bright-olive: #917c22;
        }
        .bg-custom-white { background-color: var(--color-white); }
        .text-custom-black { color: var(--color-black); }
        .bg-custom-medium-olive { background-color: var(--color-medium-olive); }
        .text-custom-bright-olive { color: var(--color-bright-olive); }
        .font-logo { font-family: 'Playfair Display', serif; font-weight: 700; }
    </style>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&display=swap" rel="stylesheet">
</head>
<body class="bg-custom-white text-custom-black min-h-screen">
    <header class="py-4 px-4 bg-custom-white shadow-sm border-b border-custom-dark-olive">
        <div class="container mx-auto flex justify-between items-center">
            <a href="{{ url_for('home') }}" class="text-2xl sm:text-3xl font-logo">
                <span class="text-custom-black">Late</span>
                <span class="text-custom-bright-olive">Night</span>
                <span class="text-custom-black block mt-0 text-xl">Cart</span>
            </a>
            <a href="{{ url_for('admin_login') }}" class="text-custom-black hover:text-custom-bright-olive text-sm">Admin</a>
        </div>
    </header>
    <main class="container mx-auto p-4 py-8">
        <h1 class="text-4xl font-bold text-center mb-10 text-custom-black">Our Delicious Snacks</h1>

        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                    <div class="p-3 mb-4 mx-auto max-w-lg rounded-md text-center text-sm {% if category == 'success' %} bg-green-100 text-green-700 {% else %} bg-red-100 text-red-700 {% endif %}">
                        {{ message }}
                    </div>
                {% endfor %}
            {% endif %}
        {% endwith %}

        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
            {% for snack in snacks %}
                {% set is_sold_out = not snack.is_available or snack.quantity == 0 %}
                <div class="bg-custom-white border border-custom-dark-olive rounded-lg shadow-md overflow-hidden transition-shadow duration-300 {% if is_sold_out %} opacity-60 {% else %} hover:shadow-lg {% endif %}">
                    <img src="{{ snack.image_url }}" alt="{{ snack.name }}" class="w-full h-48 object-cover {% if is_sold_out %} grayscale {% endif %}">
                    <div class="p-4">
                        <h2 class="text-xl font-semibold text-custom-black mb-2">{{ snack.name }}</h2>
                        <p class="text-custom-bright-olive text-lg font-bold mb-2">â‚¹ {{ "%.2f"|format(snack.price) }}</p>

                        {% if is_sold_out %}
                            <p class="text-red-600 text-sm mb-4 font-semibold">Sold Out!</p>
                            <button class="w-full bg-gray-400 text-custom-white py-2 rounded-md cursor-not-allowed" disabled>Order</button>
                        {% else %}
                            <p class="text-custom-medium-olive text-sm mb-4">Quantity available: <span class="font-semibold">{{ snack.quantity }}</span></p>
                            <a href="{{ url_for('order', snack_id=snack.id) }}" class="w-full bg-custom-black text-custom-white py-2 rounded-md hover:bg-opacity-80 transition duration-300 block text-center">
                                Order
                            </a>
                        {% endif %}
                    </div>
                </div>
            {% endfor %}
        </div>
    </main>
    <footer class="py-4 mt-8 text-center text-sm text-custom-medium-olive border-t border-custom-dark-olive">
        <p>&copy; 2025 Late Night Cart. Powered by Flask.</p>
    </footer>
</body>
</html>